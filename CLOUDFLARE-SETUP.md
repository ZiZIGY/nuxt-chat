# Настройка Cloudflare Tunnel для P2P Chat

Cloudflare Tunnel позволяет сделать ваше приложение доступным из интернета без настройки файрвола и роутера!

## Установка cloudflared

1. **Скачайте cloudflared:**
   - Перейдите на https://github.com/cloudflare/cloudflared/releases/latest
   - Скачайте `cloudflared-windows-amd64.exe`
   - Переименуйте в `cloudflared.exe`
   - Положите в папку (например, `C:\cloudflared\`)
   - Добавьте в PATH или используйте полный путь

2. **Проверьте установку:**
   ```bash
   cloudflared --version
   ```

## Запуск приложения с туннелем

### Вариант 1: Автоматический запуск (рекомендуется)

Просто запустите:
```bash
start-with-tunnel.bat
```

Этот скрипт запустит:
- Nuxt приложение (порт 3000)
- Socket.io сервер (порт 3001)
- Cloudflare Tunnel для приложения

**Важно:** Для Socket.io сервера нужно запустить отдельный туннель!

### Вариант 2: Ручной запуск

1. **Запустите Nuxt приложение:**
   ```bash
   yarn dev
   ```

2. **Запустите Socket.io сервер:**
   ```bash
   yarn dev:socket
   ```

3. **Запустите туннель для приложения:**
   ```bash
   cloudflared tunnel --url http://localhost:3000
   ```
   
   Или используйте: `start-tunnel-app.bat`

4. **Запустите туннель для Socket.io:**
   ```bash
   cloudflared tunnel --url http://localhost:3001
   ```
   
   Или используйте: `start-tunnel-socket.bat`

## Использование

После запуска вы получите два URL:

1. **URL для приложения** (например: `https://abc123.trycloudflare.com`)
   - Откройте этот URL в браузере
   - Или отправьте другу

2. **URL для Socket.io** (например: `https://xyz789.trycloudflare.com`)
   - Используйте этот URL в настройках Socket.io сервера в приложении
   - На главной странице в поле "Настройки сервера" введите этот URL

## Важно

- **Оба туннеля должны быть запущены одновременно!**
- Не закрывайте терминалы с туннелями
- При перезапуске cloudflared URL могут измениться
- Для остановки нажмите `Ctrl+C` в каждом терминале

## Пример использования

1. Запустите все сервисы (см. выше)
2. Получите URL для Socket.io (например: `https://xyz789.trycloudflare.com`)
3. Откройте URL приложения в браузере
4. На главной странице в поле "Настройки сервера" введите: `https://xyz789.trycloudflare.com`
5. Создайте комнату или подключитесь к существующей
6. Отправьте URL приложения другу
7. Друг должен также указать URL Socket.io сервера в настройках

## Преимущества

- ✅ Не требует настройки файрвола
- ✅ Не требует настройки роутера
- ✅ Работает из любой сети
- ✅ HTTPS по умолчанию
- ✅ Не блокирует IP адреса (в отличие от ngrok)

